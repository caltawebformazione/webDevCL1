(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{123:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),s=a(53),r=a.n(s),l=(a(62),a(7)),o=a(8),c=a(11),d=a(9),h=a(10),u=a(4),g=a(21),m=a(13),p=a.n(m),f=a(6),D=a.n(f),b=a(54),v=(a(48),a(49),function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).visible=!1,e.state={selectionDateRanges:[{startDate:new Date,endDate:new Date,key:"selection"}]},e}return Object(h.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.datePicker=document.querySelector(".rdrDateRangePickerWrapper"),this.definedRangesWrapper=this.datePicker.querySelector(".rdrDefinedRangesWrapper"),this.dateRangeWrapper=this.datePicker.querySelector(".rdrDateRangeWrapper"),this.monthAndYearWrapper=this.datePicker.querySelector(".rdrMonthAndYearWrapper"),this.months=this.datePicker.querySelector(".rdrMonths"),this.maxHeight="",this.maxWidth="",this.transitionDuration="",this.setInvisible(),this.dateDisplayItems=this.datePicker.querySelectorAll(".rdrDateDisplayItem"),this.dateDisplayItems[0].onclick=this.setVisible.bind(this),this.dateDisplayItems[1].onclick=this.setVisible.bind(this)}},{key:"getRangeIsSet",value:function(){return this.datePicker.querySelector(".rdrDateDisplayItemActive")===this.dateDisplayItems[1]}},{key:"setVisible",value:function(){this.visible=!0,this.definedRangesWrapper.style.maxWidth=this.maxWidth,this.definedRangesWrapper.style.maxHeight=this.maxHeight,this.monthAndYearWrapper.style.display="",this.months.style.maxHeight=this.maxHeight}},{key:"setInvisible",value:function(){var e=this;this.visible=!1,this.definedRangesWrapper.style.maxWidth="0",this.definedRangesWrapper.style.maxHeight="0",setTimeout(function(){e.monthAndYearWrapper.style.display="none"},300),this.months.style.maxHeight="0"}},{key:"handleChange",value:function(e){var t=[{startDate:e.selection.startDate,endDate:e.selection.endDate,key:"selection"}];this.setState({selectionDateRanges:t}),this.getRangeIsSet()&&(this.setInvisible(),this.props.onDateRangeSelect(t))}},{key:"render",value:function(){return i.a.createElement(b.DateRangePicker,{ranges:this.state.selectionDateRanges,onChange:this.handleChange.bind(this),showSelectionPreview:!1,showMonthAndYearPickers:!1})}}]),t}(i.a.Component)),y=a(31),k=(a(50),a(56)),S=a(55),w=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={data:[],loading:!0},e.renderText=e.renderText.bind(Object(u.a)(Object(u.a)(e))),e.renderQA=e.renderQA.bind(Object(u.a)(Object(u.a)(e))),e.fetchData=e.fetchData.bind(Object(u.a)(Object(u.a)(e))),e.columns=[{Header:"Data",accessor:"createdAt",Cell:function(e){return D()(e.value).format("DD-MM-YY")},sortable:!0,maxWidth:100},{Header:"Testo",accessor:"text",Cell:e.renderText,filterable:!1,sortable:!1,minWidth:400},{Header:"Q/A",accessor:"qa",Cell:e.renderQA,sortable:!1,maxWidth:50}],e}return Object(h.a)(t,e),Object(o.a)(t,[{key:"renderText",value:function(e){var t=this;return i.a.createElement("div",{contentEditable:"a"===e.original.qa,placeholder:"Inserire risposta ...",className:"text-box",suppressContentEditableWarning:!0,onDoubleClick:function(a){a.currentTarget.focus();var n=Object(y.a)(t.state.data);"A"===n[e.index].qa&&(n[e.index].qa="a",t.setState({data:n}))},onBlur:function(a){var n=Object(y.a)(t.state.data);n[e.index][e.column.id]=a.target.innerHTML,t.setState({data:n})},dangerouslySetInnerHTML:{__html:this.state.data[e.index][e.column.id]}})}},{key:"sendAnswer",value:function(e){var t=this,a=e.original,n=e.index;if(""!==a.text){a.qa="A";var i=void 0===a.id?"/setMessage":"/updateMessage";return p.a.post(i,a).then(function(e){var a=t.state.data;void 0===a[n].id&&(a[n].id=e.data.id),t.setState({data:a})}).catch(function(e){console.error(e.message)})}}},{key:"renderQA",value:function(e){return"a"===e.original.qa?i.a.createElement(S.IconContext.Provider,{value:{color:"green",size:"1.5em",style:{verticalAlign:"middle",weight:"bold"}}},i.a.createElement("button",{onClick:this.sendAnswer.bind(this,e)},i.a.createElement(k.FiCheck,null))):i.a.createElement("div",null,e.original.qa)}},{key:"fetchData",value:function(e,t){var a=this;this.setState({loading:!0}),p.a.post("/readMessages",{sorted:e.sorted,filtered:e.filtered,ticket:this.props.row.original.id}).then(function(t){a.newClearRow(t.data.rows),a.setState({data:t.data.rows,pages:Math.ceil(t.data.count/e.pageSize),page:e.page,filtered:e.filtered,loading:!1})})}},{key:"newClearRow",value:function(e){var t=D()().format();e.unshift({ticket:e[0].ticket,qa:"a",text:"",createdAt:t,updatedAt:t})}},{key:"render",value:function(){var e=this.state,t=e.data,a=e.loading;return i.a.createElement("div",{className:"detail"},i.a.createElement(g.a,{columns:this.columns,defaultSorted:[{id:"id",desc:!0}],data:t,loading:a,onFetchData:this.fetchData,className:"-striped -highlight",showPagination:!1,manual:!0,defaultPageSize:0}),i.a.createElement("br",null))}}]),t}(i.a.Component),x=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={data:[],pageSize:20,page:0,pages:null,loading:!0,selectionDateRanges:[{startDate:new Date,endDate:new Date,key:"selection"}]},e.handleDataTable=e.handleDataTable.bind(Object(u.a)(Object(u.a)(e))),e.handleDateSelect=e.handleDateSelect.bind(Object(u.a)(Object(u.a)(e))),e.columns=[{Header:"Ticket",columns:[{Header:"ticket",id:"id",accessor:function(e){return e.id}},{Header:"Oggetto",accessor:"subject",filterable:!1},{Header:"Data",accessor:"createdAt",filterable:!1,Cell:function(e){return D()(e.value).format("DD-MM-YY")}}]},{Header:"Utente",columns:[{Header:"Nome",accessor:"name"},{Header:"Email",accessor:"email"},{Header:"Paese",accessor:"country"}]}],e}return Object(h.a)(t,e),Object(o.a)(t,[{key:"fetchData",value:function(e){var t=this;this.setState({loading:!0});var a=D()(e.selectionDateRanges[0].startDate).format("YYYY-MM-DD"),n=D()(e.selectionDateRanges[0].endDate).format("YYYY-MM-DD");p.a.post("/readTickets",{pageSize:e.pageSize,page:e.page,sorted:e.sorted,filtered:e.filtered,startDate:a,endDate:n}).then(function(a){t.setState({data:a.data.rows,pages:Math.ceil(a.data.count/e.pageSize),page:e.page,sorted:e.sorted,filtered:e.filtered,loading:!1})})}},{key:"handleDataTable",value:function(e,t){e.selectionDateRanges=this.state.selectionDateRanges,this.fetchData(e)}},{key:"handleDateSelect",value:function(e){var t=this.state;t.selectionDateRanges=e,this.setState({selectionDateRanges:e}),this.fetchData(t)}},{key:"render",value:function(){var e=this.state,t=e.data,a=e.pages,n=e.loading;return i.a.createElement("div",{className:"App"},i.a.createElement(v,{onDateRangeSelect:this.handleDateSelect}),i.a.createElement(g.a,{columns:this.columns,manual:!0,data:t,pages:a,loading:n,onFetchData:this.handleDataTable,filterable:!0,defaultPageSize:20,style:{height:"500px"},className:"-striped -highlight",SubComponent:function(e){return i.a.createElement(w,{row:e})}}),i.a.createElement("br",null))}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},57:function(e,t,a){e.exports=a(123)},62:function(e,t,a){}},[[57,2,1]]]);
//# sourceMappingURL=main.5fa530b0.chunk.js.map